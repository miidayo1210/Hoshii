# 環境変数リスト

Hoshiiプロジェクトで使用する環境変数の一覧です。

## 📋 必須環境変数

### Supabase設定

| 変数名 | 説明 | 取得場所 |
|--------|------|----------|
| `NEXT_PUBLIC_SUPABASE_URL` | SupabaseプロジェクトのURL | Supabase Settings > API |
| `NEXT_PUBLIC_SUPABASE_ANON_KEY` | Supabase匿名キー（公開可） | Supabase Settings > API |
| `SUPABASE_SERVICE_ROLE_KEY` | Supabaseサービスロールキー（機密） | Supabase Settings > API |

**取得方法**:
1. https://app.supabase.com にアクセス
2. プロジェクトを選択
3. Settings → API をクリック
4. 表示された値をコピー

### Resend設定（メール送信）

| 変数名 | 説明 | 取得場所 |
|--------|------|----------|
| `RESEND_API_KEY` | Resend APIキー | Resend Dashboard > API Keys |
| `MAIL_FROM` | 送信元メールアドレス | カスタム設定 |

**取得方法**:
1. https://resend.com にアクセス
2. API Keys をクリック
3. 新しいAPIキーを作成
4. キーをコピー

**MAIL_FROMの形式**:
```
"Hoshii <noreply@yourdomain.com>"
```
または
```
"フルヤ建商のもり <noreply@furya.com>"
```

### アプリケーション設定

| 変数名 | 説明 | 例 |
|--------|------|-----|
| `NEXT_PUBLIC_BASE_URL` | アプリケーションのURL | `https://hoshii.vercel.app` |
| `SECRET_BROADCAST_KEY` | 管理機能用の秘密鍵 | `random-string-32-chars` |

**SECRET_BROADCAST_KEYの生成**:
```bash
openssl rand -base64 32
```

## 🛠️ 環境変数の設定方法

### ローカル開発環境

1. `.env.local.example` をコピー
2. `.env.local` を作成
3. 各環境変数の値を設定
4. `npm run dev` で起動

```bash
cp .env.local.example .env.local
# .env.local を編集して値を設定
npm run dev
```

### Vercel本番環境

1. Vercelダッシュボードにアクセス
2. プロジェクトを選択
3. Settings → Environment Variables
4. 各環境変数を追加
5. Production, Preview, Developmentすべてに設定
6. Save をクリック
7. Redeploy を実行

## 📝 環境変数の使い分け

### ローカル開発
```env
NEXT_PUBLIC_BASE_URL=http://localhost:3000
```

### プレビュー環境
```env
NEXT_PUBLIC_BASE_URL=https://hoshii-abc123.vercel.app
```

### 本番環境
```env
NEXT_PUBLIC_BASE_URL=https://hoshii.jp
```

## 🔒 セキュリティ注意事項

### 公開可能（NEXT_PUBLIC_）
- ✅ `NEXT_PUBLIC_SUPABASE_URL`
- ✅ `NEXT_PUBLIC_SUPABASE_ANON_KEY`
- ✅ `NEXT_PUBLIC_BASE_URL`

### 機密情報（公開禁止）
- ⛔ `SUPABASE_SERVICE_ROLE_KEY`
- ⛔ `RESEND_API_KEY`
- ⛔ `SECRET_BROADCAST_KEY`

⚠️ **重要**: 機密情報はGitにコミットしないでください。

## ✅ チェックリスト

デプロイ前に確認：

- [ ] すべての必須環境変数が設定されている
- [ ] Supabaseの値が正しい
- [ ] ResendのAPIキーが有効
- [ ] `NEXT_PUBLIC_BASE_URL` が正しいURLになっている
- [ ] 機密情報がGitにコミットされていない

## 🆘 トラブルシューティング

### 環境変数が読み込まれない

1. Vercelダッシュボードで再確認
2. 再デプロイを実行
3. 環境（Production/Preview/Development）が正しいか確認

### Supabase接続エラー

1. `NEXT_PUBLIC_SUPABASE_URL` が正しいか
2. `NEXT_PUBLIC_SUPABASE_ANON_KEY` が正しいか
3. Supabaseプロジェクトが有効か

### メール送信エラー

1. `RESEND_API_KEY` が正しいか
2. `MAIL_FROM` の形式が正しいか（`"名前 <email>"`）
3. Resendダッシュボードで送信ログを確認

---

📖 より詳細な情報は以下を参照：
- [DEPLOY_NOW.md](./DEPLOY_NOW.md)
- [VERCEL_QUICKSTART.md](./VERCEL_QUICKSTART.md)
- [README.md](./README.md)

